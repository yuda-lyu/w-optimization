/*!
 * w-optimization v1.0.1
 * (c) 2018-2021 yuda-lyu(semisphere)
 * Released under the MIT License.
 */
!function(t,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r():"function"==typeof define&&define.amd?define(r):(t="undefined"!=typeof globalThis?globalThis:t||self)["w-optimization"]=r()}(this,(function(){"use strict";var t=Array.isArray;function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},e="object"==r(n)&&n&&n.Object===Object&&n,o="object"==("undefined"==typeof self?"undefined":r(self))&&self&&self.Object===Object&&self,i=e||o||Function("return this")(),u=i.Symbol,a=Object.prototype,c=a.hasOwnProperty,f=a.toString,l=u?u.toStringTag:void 0;var s=function(t){var r=c.call(t,l),n=t[l];try{t[l]=void 0;var e=!0}catch(t){}var o=f.call(t);return e&&(r?t[l]=n:delete t[l]),o},v=Object.prototype.toString;var p=function(t){return v.call(t)},y=u?u.toStringTag:void 0;var h=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":y&&y in Object(t)?s(t):p(t)};var d=function(t){return null!=t&&"object"==r(t)};var b=function(t){return"symbol"==r(t)||d(t)&&"[object Symbol]"==h(t)},_=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,g=/^\w*$/;var j=function(n,e){if(t(n))return!1;var o=r(n);return!("number"!=o&&"symbol"!=o&&"boolean"!=o&&null!=n&&!b(n))||(g.test(n)||!_.test(n)||null!=e&&n in Object(e))};var O=function(t){var n=r(t);return null!=t&&("object"==n||"function"==n)};var m,w=function(t){if(!O(t))return!1;var r=h(t);return"[object Function]"==r||"[object GeneratorFunction]"==r||"[object AsyncFunction]"==r||"[object Proxy]"==r},S=i["__core-js_shared__"],x=(m=/[^.]+$/.exec(S&&S.keys&&S.keys.IE_PROTO||""))?"Symbol(src)_1."+m:"";var z=function(t){return!!x&&x in t},$=Function.prototype.toString;var A=function(t){if(null!=t){try{return $.call(t)}catch(t){}try{return t+""}catch(t){}}return""},N=/^\[object .+?Constructor\]$/,P=Function.prototype,E=Object.prototype,M=P.toString,T=E.hasOwnProperty,F=RegExp("^"+M.call(T).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var k=function(t){return!(!O(t)||z(t))&&(w(t)?F:N).test(A(t))};var I=function(t,r){return null==t?void 0:t[r]};var D=function(t,r){var n=I(t,r);return k(n)?n:void 0},C=D(Object,"create");var R=function(){this.__data__=C?C(null):{},this.size=0};var U=function(t){var r=this.has(t)&&delete this.__data__[t];return this.size-=r?1:0,r},V=Object.prototype.hasOwnProperty;var W=function(t){var r=this.__data__;if(C){var n=r[t];return"__lodash_hash_undefined__"===n?void 0:n}return V.call(r,t)?r[t]:void 0},B=Object.prototype.hasOwnProperty;var G=function(t){var r=this.__data__;return C?void 0!==r[t]:B.call(r,t)};var Z=function(t,r){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=C&&void 0===r?"__lodash_hash_undefined__":r,this};function q(t){var r=-1,n=null==t?0:t.length;for(this.clear();++r<n;){var e=t[r];this.set(e[0],e[1])}}q.prototype.clear=R,q.prototype.delete=U,q.prototype.get=W,q.prototype.has=G,q.prototype.set=Z;var H=q;var J=function(){this.__data__=[],this.size=0};var K=function(t,r){return t===r||t!=t&&r!=r};var L=function(t,r){for(var n=t.length;n--;)if(K(t[n][0],r))return n;return-1},Q=Array.prototype.splice;var X=function(t){var r=this.__data__,n=L(r,t);return!(n<0)&&(n==r.length-1?r.pop():Q.call(r,n,1),--this.size,!0)};var Y=function(t){var r=this.__data__,n=L(r,t);return n<0?void 0:r[n][1]};var tt=function(t){return L(this.__data__,t)>-1};var rt=function(t,r){var n=this.__data__,e=L(n,t);return e<0?(++this.size,n.push([t,r])):n[e][1]=r,this};function nt(t){var r=-1,n=null==t?0:t.length;for(this.clear();++r<n;){var e=t[r];this.set(e[0],e[1])}}nt.prototype.clear=J,nt.prototype.delete=X,nt.prototype.get=Y,nt.prototype.has=tt,nt.prototype.set=rt;var et=nt,ot=D(i,"Map");var it=function(){this.size=0,this.__data__={hash:new H,map:new(ot||et),string:new H}};var ut=function(t){var n=r(t);return"string"==n||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==t:null===t};var at=function(t,r){var n=t.__data__;return ut(r)?n["string"==typeof r?"string":"hash"]:n.map};var ct=function(t){var r=at(this,t).delete(t);return this.size-=r?1:0,r};var ft=function(t){return at(this,t).get(t)};var lt=function(t){return at(this,t).has(t)};var st=function(t,r){var n=at(this,t),e=n.size;return n.set(t,r),this.size+=n.size==e?0:1,this};function vt(t){var r=-1,n=null==t?0:t.length;for(this.clear();++r<n;){var e=t[r];this.set(e[0],e[1])}}vt.prototype.clear=it,vt.prototype.delete=ct,vt.prototype.get=ft,vt.prototype.has=lt,vt.prototype.set=st;var pt=vt;function yt(t,r){if("function"!=typeof t||null!=r&&"function"!=typeof r)throw new TypeError("Expected a function");var n=function n(){var e=arguments,o=r?r.apply(this,e):e[0],i=n.cache;if(i.has(o))return i.get(o);var u=t.apply(this,e);return n.cache=i.set(o,u)||i,u};return n.cache=new(yt.Cache||pt),n}yt.Cache=pt;var ht=yt;var dt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,bt=/\\(\\)?/g,_t=function(t){var r=ht(t,(function(t){return 500===n.size&&n.clear(),t})),n=r.cache;return r}((function(t){var r=[];return 46===t.charCodeAt(0)&&r.push(""),t.replace(dt,(function(t,n,e,o){r.push(e?o.replace(bt,"$1"):n||t)})),r}));var gt=function(t,r){for(var n=-1,e=null==t?0:t.length,o=Array(e);++n<e;)o[n]=r(t[n],n,t);return o},jt=u?u.prototype:void 0,Ot=jt?jt.toString:void 0;var mt=function r(n){if("string"==typeof n)return n;if(t(n))return gt(n,r)+"";if(b(n))return Ot?Ot.call(n):"";var e=n+"";return"0"==e&&1/n==-Infinity?"-0":e};var wt=function(t){return null==t?"":mt(t)};var St=function(r,n){return t(r)?r:j(r,n)?[r]:_t(wt(r))};var xt=function(t){if("string"==typeof t||b(t))return t;var r=t+"";return"0"==r&&1/t==-Infinity?"-0":r};var zt=function(t,r){for(var n=0,e=(r=St(r,t)).length;null!=t&&n<e;)t=t[xt(r[n++])];return n&&n==e?t:void 0};var $t=function(t,r,n){var e=null==t?void 0:zt(t,r);return void 0===e?n:e},At=Object.prototype;var Nt=function(t){var r=t&&t.constructor;return t===("function"==typeof r&&r.prototype||At)};var Pt=function(t,r){return function(n){return t(r(n))}}(Object.keys,Object),Et=Object.prototype.hasOwnProperty;var Mt=function(t){if(!Nt(t))return Pt(t);var r=[];for(var n in Object(t))Et.call(t,n)&&"constructor"!=n&&r.push(n);return r},Tt=D(i,"DataView"),Ft=D(i,"Promise"),kt=D(i,"Set"),It=D(i,"WeakMap"),Dt="[object Map]",Ct="[object Promise]",Rt="[object Set]",Ut="[object WeakMap]",Vt="[object DataView]",Wt=A(Tt),Bt=A(ot),Gt=A(Ft),Zt=A(kt),qt=A(It),Ht=h;(Tt&&Ht(new Tt(new ArrayBuffer(1)))!=Vt||ot&&Ht(new ot)!=Dt||Ft&&Ht(Ft.resolve())!=Ct||kt&&Ht(new kt)!=Rt||It&&Ht(new It)!=Ut)&&(Ht=function(t){var r=h(t),n="[object Object]"==r?t.constructor:void 0,e=n?A(n):"";if(e)switch(e){case Wt:return Vt;case Bt:return Dt;case Gt:return Ct;case Zt:return Rt;case qt:return Ut}return r});var Jt=Ht;var Kt=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991};var Lt=function(t){return null!=t&&Kt(t.length)&&!w(t)};var Qt=function(r){return"string"==typeof r||!t(r)&&d(r)&&"[object String]"==h(r)};var Xt=function(t){return function(r){return null==r?void 0:r[t]}}("length"),Yt=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");var tr=function(t){return Yt.test(t)},rr="[\\ud800-\\udfff]",nr="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",er="\\ud83c[\\udffb-\\udfff]",or="[^\\ud800-\\udfff]",ir="(?:\\ud83c[\\udde6-\\uddff]){2}",ur="[\\ud800-\\udbff][\\udc00-\\udfff]",ar="(?:"+nr+"|"+er+")"+"?",cr="[\\ufe0e\\ufe0f]?",fr=cr+ar+("(?:\\u200d(?:"+[or,ir,ur].join("|")+")"+cr+ar+")*"),lr="(?:"+[or+nr+"?",nr,ir,ur,rr].join("|")+")",sr=RegExp(er+"(?="+er+")|"+lr+fr,"g");var vr=function(t){for(var r=sr.lastIndex=0;sr.test(t);)++r;return r};var pr=function(t){return tr(t)?vr(t):Xt(t)};var yr=function(t){if(null==t)return 0;if(Lt(t))return Qt(t)?pr(t):t.length;var r=Jt(t);return"[object Map]"==r||"[object Set]"==r?t.size:Mt(t).length};function hr(t){return"[object String]"===Object.prototype.toString.call(t)}function dr(t){var r=!1;return!function(t){return!(!hr(t)||""===t)}(t)?function(t){return"[object Number]"===Object.prototype.toString.call(t)}(t)&&(r=!0):r=!isNaN(Number(t)),r}function br(t){var r=Object.prototype.toString.call(t);return"[object Function]"===r||"[object AsyncFunction]"===r}function _r(t){return"[object Array]"===Object.prototype.toString.call(t)}function gr(t){if(function(t){return"[object Object]"===Object.prototype.toString.call(t)}(t)){for(var r in t)return!1;return!0}return!1}function jr(t){return!!function(t){return"[object Undefined]"===Object.prototype.toString.call(t)}(t)||(!!function(t){return"[object Null]"===Object.prototype.toString.call(t)}(t)||(!!gr(t)||(!!function(t){return!(!hr(t)||""!==t)}(t)||!!function(t){return!!_r(t)&&0===t.length}(t))))}function Or(t){return!!_r(t)&&(0!==t.length&&(1!==t.length||!jr(t[0])))}var mr=/\s/;var wr=function(t){for(var r=t.length;r--&&mr.test(t.charAt(r)););return r},Sr=/^\s+/;var xr=function(t){return t?t.slice(0,wr(t)+1).replace(Sr,""):t},zr=/^[-+]0x[0-9a-f]+$/i,$r=/^0b[01]+$/i,Ar=/^0o[0-7]+$/i,Nr=parseInt;var Pr=function(t){if("number"==typeof t)return t;if(b(t))return NaN;if(O(t)){var r="function"==typeof t.valueOf?t.valueOf():t;t=O(r)?r+"":r}if("string"!=typeof t)return 0===t?t:+t;t=xr(t);var n=$r.test(t);return n||Ar.test(t)?Nr(t.slice(2),n?2:8):zr.test(t)?NaN:+t},Er=1/0;var Mr=function(t){return t?(t=Pr(t))===Er||t===-1/0?17976931348623157e292*(t<0?-1:1):t==t?t:0:0===t?t:0};function Tr(t){return dr(t)?Mr(t):0}function Fr(t,r,n,e,o){for(var i=0;i<t.length;++i)t[i]=r*n[i]+e*o[i]}function kr(t,r){return t.y-r.y}return{nelderMead:function(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!br(t))throw new Error("invalid fun");if(!Or(r))throw new Error("x0 is not an effective array");var e=yr(r),o=$t(n,"maxIterations");dr(o)||(o=200*e),o=Tr(o);var i=$t(n,"nonZeroDelta");dr(i)||(i=1.05),i=Tr(i);var u=$t(n,"zeroDelta");dr(u)||(u=.001),u=Tr(u);var a=$t(n,"minErrorDelta");dr(a)||(a=1e-6),a=Tr(a);var c=$t(n,"minTolerance");dr(c)||(c=1e-5),c=Tr(c);var f=$t(n,"rho");dr(f)||(f=1),f=Tr(f);var l=$t(n,"chi");dr(l)||(l=2),l=Tr(l);var s=$t(n,"psi");dr(s)||(s=-.5),s=Tr(s);var v=$t(n,"sigma");dr(v)||(v=.5),v=Tr(v);var p=new Array(e+1);p[0]=r,p[0].y=t(r),p[0].id=0;for(var y=0;y<e;++y){var h=r.slice();h[y]=h[y]?h[y]*i:u,p[y+1]=h,p[y+1].y=t(h),p[y+1].id=y+1}for(var d,b=function(t){for(var r=0;r<t.length;r++)p[e][r]=t[r];p[e].y=t.y},_=r.slice(),g=r.slice(),j=r.slice(),O=r.slice(),m=0;m<o;++m){if(p.sort(kr),n.history){var w=p.map((function(t){var r=t.slice();return r.y=t.y,r.id=t.id,r}));w.sort((function(t,r){return t.id-r.id})),n.history.push({x:p[0].slice(),y:p[0].y,simplex:w})}d=0;for(var S=0;S<e;++S)d=Math.max(d,Math.abs(p[0][S]-p[1][S]));if(Math.abs(p[0].y-p[e].y)<a&&d<c)break;for(var x=0;x<e;++x){_[x]=0;for(var z=0;z<e;++z)_[x]+=p[z][x];_[x]/=e}var $=p[e];if(Fr(g,1+f,_,-f,$),g.y=t(g),g.y<p[0].y)Fr(O,1+l,_,-l,$),O.y=t(O),O.y<g.y?b(O):b(g);else if(g.y>=p[e-1].y){var A=!1;if(g.y>$.y?(Fr(j,1+s,_,-s,$),j.y=t(j),j.y<$.y?b(j):A=!0):(Fr(j,1-s*f,_,s*f,$),j.y=t(j),j.y<g.y?b(j):A=!0),A){if(v>=1)break;for(var N=1;N<p.length;++N)Fr(p[N],1-v,p[0],v,p[N]),p[N].y=t(p[N])}}else b(g)}p.sort(kr);for(var P=[],E=p[0],M=0;M<e;M++)P.push(E[M]);return{y:p[0].y,x:P}}}}));
//# sourceMappingURL=w-optimization.umd.js.map
